# Good Todo Go

PostgreSQL ã® **Row Level Security (RLS)** ã‚’ç”¨ã„ãŸãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ã‚’å­¦ç¿’ãƒ»å®Ÿè·µã™ã‚‹ãŸã‚ã«ä½œæˆã—ãŸ Todo ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

Go + Echo ã«ã‚ˆã‚‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API ã¨ Next.js + shadcn/ui ã«ã‚ˆã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ä»¥ä¸‹ã®æŠ€è¡“ã‚’å­¦ç¿’ãƒ»å®Ÿè·µã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ï¼š

- **RLS (Row Level Security)** ã«ã‚ˆã‚‹ãƒ†ãƒŠãƒ³ãƒˆé–“ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£** ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³
- **ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£** ã«ã‚ˆã‚‹Goãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®è¨­è¨ˆ
- **OpenAPI (oapi-codegen)** ã‚’ç”¨ã„ãŸå‹å®‰å…¨ãªAPIé–‹ç™º

## é–‹ç™ºçŠ¶æ³

| æ©Ÿèƒ½ | çŠ¶æ…‹ |
|------|------|
| Public API | âœ… å®Œæˆ |
| Admin API | ğŸš§ æœªå®Ÿè£… |
| Frontend (shadcn/ui) | âœ… å®Œæˆ |
| Unit Tests | âœ… å®Ÿè£…æ¸ˆã¿ |
| Integration Tests | âœ… å®Ÿè£…æ¸ˆã¿ |

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ |
|----------|------|
| è¨€èª | Go 1.24 |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Echo v4 |
| ORM | Ent (ã‚³ãƒ¼ãƒ‰ç”Ÿæˆå‹) |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | PostgreSQL 17 |
| ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | Atlas |
| èªè¨¼ | JWT (ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ + ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³) |
| DI | Uber Dig |
| APIä»•æ§˜ | OpenAPI 3.0 + oapi-codegen |

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ |
|----------|------|
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Next.js 16 (App Router) |
| è¨€èª | TypeScript 5 |
| UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª | React 19 |
| ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° | Tailwind CSS v4 |
| çŠ¶æ…‹ç®¡ç† | TanStack React Query v5 |
| ãƒ•ã‚©ãƒ¼ãƒ  | React Hook Form + Zod |
| UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | Radix UI + shadcn/ui |
| APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | Orval (è‡ªå‹•ç”Ÿæˆ) |

### ã‚¤ãƒ³ãƒ•ãƒ©
- Docker & Docker Compose
- MailHog (é–‹ç™ºç”¨ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼)
- Atlas (ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†)

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
backend/
â”œâ”€â”€ cmd/                    # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ api/               # APIã‚µãƒ¼ãƒãƒ¼
â”‚   â””â”€â”€ test_rls/          # RLSãƒ†ã‚¹ãƒˆç”¨
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ domain/            # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ (ãƒ¢ãƒ‡ãƒ«ã€ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹)
â”‚   â”œâ”€â”€ infrastructure/    # ã‚¤ãƒ³ãƒ•ãƒ©å±¤ (DBæ¥ç¶šã€ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…)
â”‚   â”œâ”€â”€ usecase/           # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å±¤ (ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯)
â”‚   â””â”€â”€ presentation/      # ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚       â”œâ”€â”€ public/        # å…¬é–‹API (v1) âœ…
â”‚       â””â”€â”€ admin/         # ç®¡ç†API ğŸš§
â”œâ”€â”€ openapi/               # OpenAPIä»•æ§˜
â””â”€â”€ Makefile               # ãƒ“ãƒ«ãƒ‰ãƒ»é–‹ç™ºã‚³ãƒãƒ³ãƒ‰
```

### RLS ã«ã‚ˆã‚‹ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ ¸å¿ƒã¨ãªã‚‹æ©Ÿèƒ½ã§ã™ã€‚PostgreSQL ã® Row Level Security ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ†ãƒŠãƒ³ãƒˆé–“ã®ãƒ‡ãƒ¼ã‚¿ã‚’å®Œå…¨ã«åˆ†é›¢ã—ã¦ã„ã¾ã™ã€‚

```sql
-- RLS ã®æœ‰åŠ¹åŒ–
ALTER TABLE "users" ENABLE ROW LEVEL SECURITY;
ALTER TABLE "todos" ENABLE ROW LEVEL SECURITY;

-- ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ãƒãƒªã‚·ãƒ¼
CREATE POLICY "users_tenant_isolation" ON "users"
    FOR ALL
    USING ("tenant_id" = current_setting('app.current_tenant_id', true))
    WITH CHECK ("tenant_id" = current_setting('app.current_tenant_id', true));
```

**å‹•ä½œã®ä»•çµ„ã¿:**
1. JWTãƒˆãƒ¼ã‚¯ãƒ³ã« `tenant_id` ã‚’å«ã‚ã‚‹
2. ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ `SET app.current_tenant_id = '<tenant_id>'` ã‚’å®Ÿè¡Œ
3. RLSãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚Šã€è‡ªå‹•çš„ã«è©²å½“ãƒ†ãƒŠãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

## ä¸»ãªæ©Ÿèƒ½

### èªè¨¼ãƒ»èªå¯
- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ã‚ˆã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
- ãƒ¡ãƒ¼ãƒ«èªè¨¼ (ãƒˆãƒ¼ã‚¯ãƒ³æ–¹å¼)
- JWTèªè¨¼ (ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ + ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³)
- è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥

### ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ™‚ã«ãƒ†ãƒŠãƒ³ãƒˆ (ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹) ã‚’è‡ªå‹•ä½œæˆ
- RLS ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†é›¢ (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã§ã®æ˜ç¤ºçš„ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ä¸è¦)
- ãƒ†ãƒŠãƒ³ãƒˆé–“ã®ãƒ‡ãƒ¼ã‚¿å®Œå…¨åˆ†é›¢

### Todoç®¡ç†
- Todoä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤
- å®Œäº†çŠ¶æ…‹ã®ç®¡ç†
- å…¬é–‹/éå…¬é–‹è¨­å®š (ãƒ†ãƒŠãƒ³ãƒˆå†…ã§ã®å…±æœ‰)
- æœŸæ—¥è¨­å®š

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å¿…è¦æ¡ä»¶
- Go 1.24+
- Node.js 20+
- Docker & Docker Compose

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

```bash
cd backend

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cp .env.example .env

# Dockerã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹• (PostgreSQL, MailHog, è‡ªå‹•ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³)
docker compose up -d

# ã¾ãŸã¯ã€æ‰‹å‹•ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆ
make run              # DBã®ã¿èµ·å‹•
make migrate_apply    # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
make dev
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

```bash
cd frontend

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cp .env.example .env

# APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç”Ÿæˆ
npm run generate:api

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
npm run dev
```

### ã‚¢ã‚¯ã‚»ã‚¹å…ˆ
| ã‚µãƒ¼ãƒ“ã‚¹ | URL |
|----------|-----|
| Frontend | http://localhost:3000 |
| Public API | http://localhost:8000 |
| MailHog (ãƒ¡ãƒ¼ãƒ«ç¢ºèª) | http://localhost:8025 |

## é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (Makefile)

```bash
# Docker
make run                 # Dockerã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•
make stop                # Dockerã‚µãƒ¼ãƒ“ã‚¹åœæ­¢

# é–‹ç™º
make dev                 # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• (ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãªã—)

# ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
make generate_ent        # Ent ORMã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
make oapi-gen            # OpenAPIã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
make migrate_diff        # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
make migrate_apply       # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
make migrate_status      # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç¢ºèª
make migrate_down n=1    # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

# ãƒ†ã‚¹ãƒˆ
make test_unit           # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
make test_integration    # çµ±åˆãƒ†ã‚¹ãƒˆ
make test                # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

# ã‚³ãƒ¼ãƒ‰å“è³ª
make fmt                 # ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
make lint                # ãƒªãƒ³ãƒˆ
make vet                 # vet
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (npm scripts)

```bash
npm run dev              # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run build            # ãƒ“ãƒ«ãƒ‰
npm run generate:api     # APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ
npm run lint             # ãƒªãƒ³ãƒˆ
```

## ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆæ§‹æˆ

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã¯2ç¨®é¡ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ï¼š

| ãƒ†ã‚¹ãƒˆç¨®åˆ¥ | å¯¾è±¡ | å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ |
|-----------|------|-------------|
| Unit Tests | Usecaseå±¤ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ | `make test_unit` |
| Integration Tests | Controller â†’ Usecase â†’ Repository ã®çµåˆ | `make test_integration` |

### Unit Tests

ãƒ¢ãƒƒã‚¯ (`mockgen`) ã‚’ä½¿ç”¨ã—ã¦ã€ä¾å­˜é–¢ä¿‚ã‚’åˆ†é›¢ã—ãŸãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
internal/
â”œâ”€â”€ usecase/
â”‚   â”œâ”€â”€ todo.go
â”‚   â”œâ”€â”€ todo_test.go      # TodoInteractorã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ user.go
â”‚   â””â”€â”€ user_test.go      # UserInteractorã®ãƒ†ã‚¹ãƒˆ
â””â”€â”€ domain/repository/mock/  # mockgenã§ç”Ÿæˆã•ã‚ŒãŸãƒ¢ãƒƒã‚¯
```

### Integration Tests

**Testcontainers** ã‚’ä½¿ç”¨ã—ã¦ã€å®Ÿéš›ã®PostgreSQLã‚³ãƒ³ãƒ†ãƒŠã§RLSã‚’å«ã‚€çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
internal/integration_test/
â”œâ”€â”€ common/
â”‚   â”œâ”€â”€ setup.go          # ãƒ†ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒŠã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚   â””â”€â”€ testdata.go       # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ˜ãƒ«ãƒ‘ãƒ¼
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ auth_test.go      # èªè¨¼ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ todo_test.go      # Todoãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ user_test.go      # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ helper_test.go    # ãƒ†ã‚¹ãƒˆç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼
â””â”€â”€ rls_test.go           # RLSãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ãƒ†ã‚¹ãƒˆ
```

**ç‰¹å¾´:**

- å„ãƒ†ã‚¹ãƒˆã§ç‹¬ç«‹ã—ãŸPostgreSQLã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•
- Atlasãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•é©ç”¨
- RLSé©ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (`app_user`) ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€æœ¬ç•ªç’°å¢ƒã¨åŒã˜æ¡ä»¶ã§ãƒ†ã‚¹ãƒˆ
- ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ (RLS) ã®å‹•ä½œã‚’æ¤œè¨¼

```bash
# çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¾‹
make test_integration

# å®Ÿè¡Œçµæœ (æŠœç²‹)
=== RUN   TestTodo_GetPublicTodos
--- PASS: TestTodo_GetPublicTodos (3.61s)
    --- PASS: TestTodo_GetPublicTodos/success_-_get_public_todos_in_Tenant1 (0.01s)
    --- PASS: TestTodo_GetPublicTodos/success_-_get_public_todos_in_Tenant2 (0.00s)
```

## API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### Public API (å®Ÿè£…æ¸ˆã¿)

#### èªè¨¼
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| POST | `/api/v1/auth/register` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ² |
| POST | `/api/v1/auth/login` | ãƒ­ã‚°ã‚¤ãƒ³ |
| POST | `/api/v1/auth/verify-email` | ãƒ¡ãƒ¼ãƒ«èªè¨¼ |
| POST | `/api/v1/auth/refresh` | ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ |

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| GET | `/api/v1/me` | ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾— |
| PUT | `/api/v1/me` | ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–° |

#### Todo
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| GET | `/api/v1/todos` | è‡ªåˆ†ã®Todoä¸€è¦§å–å¾— |
| GET | `/api/v1/todos/public` | å…¬é–‹Todoä¸€è¦§å–å¾— (ãƒ†ãƒŠãƒ³ãƒˆå†…) |
| POST | `/api/v1/todos` | Todoä½œæˆ |
| PUT | `/api/v1/todos/:id` | Todoæ›´æ–° |
| DELETE | `/api/v1/todos/:id` | Todoå‰Šé™¤ |

### Admin API (æœªå®Ÿè£…)

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| GET | `/api/admin/tenants` | ãƒ†ãƒŠãƒ³ãƒˆä¸€è¦§ |
| POST | `/api/admin/tenants` | ãƒ†ãƒŠãƒ³ãƒˆä½œæˆ |
| ... | ... | ... |

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹æˆ

**tenants** - ãƒ†ãƒŠãƒ³ãƒˆ (ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹)
- `id` (UUID), `name`, `slug`, `created_at`, `updated_at`

**users** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ (RLSé©ç”¨)
- `id` (UUID), `tenant_id`, `email`, `password_hash`, `name`, `role`
- `email_verified`, `verification_token`, `verification_token_expires_at`
- `created_at`, `updated_at`

**todos** - Todo (RLSé©ç”¨)
- `id` (UUID), `tenant_id`, `user_id`, `title`, `description`
- `completed`, `is_public`, `due_date`, `completed_at`
- `created_at`, `updated_at`

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Application                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              JWT Middleware                          â”‚   â”‚
â”‚  â”‚  - tenant_id ã‚’JWTã‹ã‚‰å–å¾—                           â”‚   â”‚
â”‚  â”‚  - SET app.current_tenant_id ã‚’å®Ÿè¡Œ                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PostgreSQL                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Row Level Security                      â”‚   â”‚
â”‚  â”‚  - app.current_tenant_id ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°            â”‚   â”‚
â”‚  â”‚  - ä»–ãƒ†ãƒŠãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã«ã¯ä¸€åˆ‡ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
good-todo-go/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ cmd/
â”‚   â”‚   â”œâ”€â”€ api/                    # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ test_rls/               # RLSãƒ†ã‚¹ãƒˆç”¨
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”‚   â”œâ”€â”€ model/              # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ repository/         # ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ ent/                    # Ent ORM (è‡ªå‹•ç”Ÿæˆ)
â”‚   â”‚   â”‚   â”œâ”€â”€ schema/             # ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â”‚   â”‚   â””â”€â”€ migrate/migrations/ # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³SQL
â”‚   â”‚   â”œâ”€â”€ infrastructure/         # ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ã€DBæ¥ç¶š
â”‚   â”‚   â”œâ”€â”€ usecase/                # ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ (ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯)
â”‚   â”‚   â””â”€â”€ presentation/
â”‚   â”‚       â”œâ”€â”€ public/             # Public API âœ…
â”‚   â”‚       â””â”€â”€ admin/              # Admin API ğŸš§
â”‚   â”œâ”€â”€ openapi/                    # OpenAPIä»•æ§˜
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ Dockerfile.api.local
â”‚   â”œâ”€â”€ Dockerfile.migrate
â”‚   â””â”€â”€ Makefile
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”‚   â”œâ”€â”€ (auth)/             # èªè¨¼ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”‚   â””â”€â”€ (main)/             # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ api/                    # ç”Ÿæˆã•ã‚ŒãŸAPIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                 # shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ todo/               # Todoã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â””â”€â”€ user/               # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ contexts/               # Reactã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”‚   â”‚   â””â”€â”€ providers/              # ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
â”‚   â”œâ”€â”€ orval.config.ts             # APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆè¨­å®š
â”‚   â””â”€â”€ package.json
â””â”€â”€ README.md
```

## ç’°å¢ƒå¤‰æ•°

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (.env)
```env
# PostgreSQL (ç®¡ç†è€…)
POSTGRES_DB_USER=postgres
POSTGRES_DB_PASSWORD=postgres
POSTGRES_DB_NAME=good_todo_go
POSTGRES_DB_PORT=5432
POSTGRES_DB_HOST=localhost

# PostgreSQL (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ - RLSé©ç”¨)
POSTGRES_APP_USER=app
POSTGRES_APP_PASSWORD=app

# JWT
JWT_SECRET=your-super-secret-jwt-key

# Server
PUBLIC_API_PORT=8000
ADMIN_API_PORT=8001
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (.env)
```env
NEXT_PUBLIC_API_BASE_URL=http://localhost:8000/api/v1
```

